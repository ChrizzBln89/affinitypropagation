[32m2023-10-11 09:46:43 +0200[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 225e69cc-d348-4efc-b79b-34242b4e5066 - 1199885 - LOGS_CAPTURED - Started capturing logs in process (pid: 1199885).
[32m2023-10-11 09:46:43 +0200[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 225e69cc-d348-4efc-b79b-34242b4e5066 - 1199885 - upload_index_quotes - STEP_START - Started execution of step "upload_index_quotes".
[32m2023-10-11 09:46:43 +0200[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 225e69cc-d348-4efc-b79b-34242b4e5066 - upload_index_quotes - Loading file from: /home/chris/code/affinitypropagation/valuationhub/tmptuaruuxa/storage/download_index_ticker using PickledObjectFilesystemIOManager...
[32m2023-10-11 09:46:43 +0200[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 225e69cc-d348-4efc-b79b-34242b4e5066 - 1199885 - upload_index_quotes - ASSET_OBSERVATION - DagsterEventType.ASSET_OBSERVATION for step upload_index_quotes
[32m2023-10-11 09:46:43 +0200[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 225e69cc-d348-4efc-b79b-34242b4e5066 - 1199885 - upload_index_quotes - LOADED_INPUT - Loaded input "download_index_ticker" using input manager "io_manager"
[32m2023-10-11 09:46:43 +0200[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 225e69cc-d348-4efc-b79b-34242b4e5066 - 1199885 - upload_index_quotes - STEP_INPUT - Got input "download_index_ticker" of type "Any". (Type check passed).
Progress merge:   0%|[38;2;0;209;17m                                                        [0m| 0/36 [00:00<?, ?it/s][0mProgress merge:   3%|[38;2;0;209;17m█▎                                              [0m| 1/36 [00:00<00:24,  1.41it/s][0mProgress merge:   6%|[38;2;0;209;17m██▋                                             [0m| 2/36 [00:01<00:22,  1.48it/s][0mProgress merge:   8%|[38;2;0;209;17m████                                            [0m| 3/36 [00:01<00:20,  1.59it/s][0mProgress merge:  11%|[38;2;0;209;17m█████▎                                          [0m| 4/36 [00:02<00:18,  1.69it/s][0mProgress merge:  14%|[38;2;0;209;17m██████▋                                         [0m| 5/36 [00:03<00:18,  1.64it/s][0mProgress merge:  17%|[38;2;0;209;17m████████                                        [0m| 6/36 [00:03<00:20,  1.49it/s][0mProgress merge:  19%|[38;2;0;209;17m█████████▎                                      [0m| 7/36 [00:04<00:19,  1.47it/s][0mProgress merge:  22%|[38;2;0;209;17m██████████▋                                     [0m| 8/36 [00:05<00:18,  1.52it/s][0mProgress merge:  25%|[38;2;0;209;17m████████████                                    [0m| 9/36 [00:05<00:17,  1.52it/s][0mProgress merge:  28%|[38;2;0;209;17m█████████████                                  [0m| 10/36 [00:06<00:16,  1.55it/s][0mProgress merge:  31%|[38;2;0;209;17m██████████████▎                                [0m| 11/36 [00:07<00:15,  1.62it/s][0mProgress merge:  33%|[38;2;0;209;17m███████████████▋                               [0m| 12/36 [00:07<00:15,  1.54it/s][0mIMOEX.ME: No price data found, symbol may be delisted (period=1d)
Progress merge:  36%|[38;2;0;209;17m████████████████▉                              [0m| 13/36 [00:08<00:15,  1.50it/s][0mProgress merge:  39%|[38;2;0;209;17m██████████████████▎                            [0m| 14/36 [00:08<00:13,  1.61it/s][0mProgress merge:  42%|[38;2;0;209;17m███████████████████▌                           [0m| 15/36 [00:09<00:13,  1.57it/s][0mProgress merge:  44%|[38;2;0;209;17m████████████████████▉                          [0m| 16/36 [00:10<00:12,  1.63it/s][0mProgress merge:  47%|[38;2;0;209;17m██████████████████████▏                        [0m| 17/36 [00:10<00:11,  1.65it/s][0mProgress merge:  50%|[38;2;0;209;17m███████████████████████▌                       [0m| 18/36 [00:11<00:10,  1.66it/s][0mProgress merge:  53%|[38;2;0;209;17m████████████████████████▊                      [0m| 19/36 [00:12<00:10,  1.63it/s][0mProgress merge:  56%|[38;2;0;209;17m██████████████████████████                     [0m| 20/36 [00:12<00:10,  1.57it/s][0mProgress merge:  58%|[38;2;0;209;17m███████████████████████████▍                   [0m| 21/36 [00:13<00:09,  1.58it/s][0mProgress merge:  61%|[38;2;0;209;17m████████████████████████████▋                  [0m| 22/36 [00:13<00:08,  1.64it/s][0mProgress merge:  64%|[38;2;0;209;17m██████████████████████████████                 [0m| 23/36 [00:14<00:07,  1.68it/s][0mProgress merge:  67%|[38;2;0;209;17m███████████████████████████████▎               [0m| 24/36 [00:15<00:07,  1.70it/s][0mProgress merge:  69%|[38;2;0;209;17m████████████████████████████████▋              [0m| 25/36 [00:15<00:06,  1.69it/s][0mProgress merge:  72%|[38;2;0;209;17m█████████████████████████████████▉             [0m| 26/36 [00:16<00:06,  1.66it/s][0mProgress merge:  75%|[38;2;0;209;17m███████████████████████████████████▎           [0m| 27/36 [00:16<00:05,  1.70it/s][0mProgress merge:  78%|[38;2;0;209;17m████████████████████████████████████▌          [0m| 28/36 [00:17<00:04,  1.71it/s][0mProgress merge:  81%|[38;2;0;209;17m█████████████████████████████████████▊         [0m| 29/36 [00:18<00:04,  1.69it/s][0mProgress merge:  83%|[38;2;0;209;17m███████████████████████████████████████▏       [0m| 30/36 [00:18<00:03,  1.61it/s][0mProgress merge:  86%|[38;2;0;209;17m████████████████████████████████████████▍      [0m| 31/36 [00:19<00:03,  1.64it/s][0m^IPSA: No price data found, symbol may be delisted (period=1d)
Progress merge:  89%|[38;2;0;209;17m█████████████████████████████████████████▊     [0m| 32/36 [00:19<00:02,  1.69it/s][0mProgress merge:  92%|[38;2;0;209;17m███████████████████████████████████████████    [0m| 33/36 [00:20<00:01,  1.66it/s][0mProgress merge:  94%|[38;2;0;209;17m████████████████████████████████████████████▍  [0m| 34/36 [00:21<00:01,  1.69it/s][0mProgress merge:  97%|[38;2;0;209;17m█████████████████████████████████████████████▋ [0m| 35/36 [00:21<00:00,  1.62it/s][0mProgress merge: 100%|[38;2;0;209;17m███████████████████████████████████████████████[0m| 36/36 [00:22<00:00,  1.23it/s][0mProgress merge: 100%|[38;2;0;209;17m███████████████████████████████████████████████[0m| 36/36 [00:22<00:00,  1.57it/s][0m
[32m2023-10-11 09:47:08 +0200[0m - dagster - [34mERROR[0m - [31m__ASSET_JOB - 225e69cc-d348-4efc-b79b-34242b4e5066 - 1199885 - upload_index_quotes - STEP_FAILURE - Execution of step "upload_index_quotes" failed.

dagster._core.errors.DagsterExecutionStepExecutionError: Error occurred while executing op "upload_index_quotes"::

pyarrow.lib.ArrowTypeError: Expected bytes, got a 'Timestamp' object

Stack Trace:
  File "/home/chris/.pyenv/versions/3.11.4/lib/python3.11/site-packages/dagster/_core/execution/plan/utils.py", line 54, in op_execution_error_boundary
    yield
  File "/home/chris/.pyenv/versions/3.11.4/lib/python3.11/site-packages/dagster/_utils/__init__.py", line 443, in iterate_with_context
    next_output = next(iterator)
                  ^^^^^^^^^^^^^^
  File "/home/chris/.pyenv/versions/3.11.4/lib/python3.11/site-packages/dagster/_core/execution/plan/compute_generator.py", line 136, in _coerce_op_compute_fn_to_iterator
    result = invoke_compute_fn(
             ^^^^^^^^^^^^^^^^^^
  File "/home/chris/.pyenv/versions/3.11.4/lib/python3.11/site-packages/dagster/_core/execution/plan/compute_generator.py", line 130, in invoke_compute_fn
    return fn(context, **args_to_pass) if context_arg_provided else fn(**args_to_pass)
                                                                    ^^^^^^^^^^^^^^^^^^
  File "/home/chris/code/affinitypropagation/valuationhub/valuationhub/assets.py", line 94, in upload_index_quotes
    to_gbq(
  File "/home/chris/.pyenv/versions/3.11.4/lib/python3.11/site-packages/pandas_gbq/gbq.py", line 1220, in to_gbq
    connector.load_data(
  File "/home/chris/.pyenv/versions/3.11.4/lib/python3.11/site-packages/pandas_gbq/gbq.py", line 602, in load_data
    chunks = load.load_chunks(
             ^^^^^^^^^^^^^^^^^
  File "/home/chris/.pyenv/versions/3.11.4/lib/python3.11/site-packages/pandas_gbq/load.py", line 243, in load_chunks
    load_parquet(
  File "/home/chris/.pyenv/versions/3.11.4/lib/python3.11/site-packages/pandas_gbq/load.py", line 131, in load_parquet
    client.load_table_from_dataframe(
  File "/home/chris/.pyenv/versions/3.11.4/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2705, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
  File "/home/chris/.pyenv/versions/3.11.4/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 719, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/chris/.pyenv/versions/3.11.4/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 662, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
  File "/home/chris/.pyenv/versions/3.11.4/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 380, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1099, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 323, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 83, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 123, in pyarrow.lib.check_status
[0m
